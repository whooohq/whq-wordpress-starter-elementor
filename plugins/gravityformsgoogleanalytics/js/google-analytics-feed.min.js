!function(s){jQuery(document).ready(function(){var n=new URLSearchParams(window.location.search).get("settingstype");function l(){s("#ga_event_goal_id, #ga_event_goal_thickbox, #ga_event_action_thickbox, #ga_event_label_thickbox, #ga_event_value_thickbox, #ga_event_category_thickbox").removeAttr("disabled"),s("#goal_select_edit, .gforms_goal_edit_heading, #use_goal, #edit_goal").hide(),s("#goal_labels, .gforms_goal_create_heading, #create_goal, #cancel_goal").show();var e="form"===n?"pagination_":"";s("#ga_event_category_thickbox").prop("value",gforms_google_analytics_feed_strings[e+"category"]),s("#ga_event_action_thickbox").prop("value",gforms_google_analytics_feed_strings[e+"action"]),s("#ga_event_label_thickbox").prop("value",gforms_google_analytics_feed_strings[e+"label"]),s("#ga_event_goal_thickbox").prop("value",gforms_google_analytics_feed_strings[e+"goal"]).focus()}function i(){var e,a,t,o,_=s("#goal_select option:selected");0!==s(".gform-addon-gtm-manual-config").length?(s("#ga_event_category_thickbox, #ga_event_action_thickbox, #ga_event_label_thickbox, #ga_event_goal_thickbox").prop("disabled","disabled"),s("#goal_labels, .gforms_goal_create_heading, #create_goal").hide(),s("#use_goal, #edit_goal, #goal_select_edit").show(),s("#gform_setting_feed_event_category, #gform_setting_feed_event_action, #gform_setting_feed_event_label").show()):0===_.length?l():(s("#ga_event_category_thickbox, #ga_event_action_thickbox, #ga_event_label_thickbox, #ga_event_goal_thickbox").prop("disabled","disabled"),s("#goal_labels, .gforms_goal_create_heading, #create_goal").hide(),s("#use_goal, #edit_goal, #goal_select_edit").show(),s("#gform_setting_feed_event_category, #gform_setting_feed_event_action, #gform_setting_feed_event_label").show(),e=_.attr("data-category"),a=_.attr("data-action"),t=s.trim(_.attr("data-label")),o=_.attr("data-goal-id"),s("#gaeventgoalid_thickbox").prop("value",o),s("#ga_event_goal_thickbox").prop("value",_.html()),s("#ga_event_category_thickbox").prop("value",e),s("#ga_event_action_thickbox").prop("value",a),s("#ga_event_label_thickbox").prop("value",t))}function r(){s(".gform-addon-conversion-tracking-modal .gform-alert").remove(),s('.gform-addon-conversion-tracking-modal [required="required"]').removeAttr("aria-describedby").closest(".gform-settings-input__container").removeClass("gform-settings-input__container--invalid"),s(".gform-addon-conversion-tracking-modal .gform-settings-validation__error").remove()}function c(e){var a,t;s(".gform-addon-conversion-tracking-modal .gform-alert").length||(a='<div class="gform-alert gform-alert--error gform-alert--inline">',a=(a+='<span class="gform-alert__icon gform-icon gform-icon--circle-close" aria-hidden="true"></span>')+'<div class="gform-alert__message-wrap"><span class="gform-alert__message">'+e.data[0].message+"</span></div></div>",s("#goal_labels").prepend(a)),"missing_values"===e.data[0].code&&(t=s("#goal_labels").find('[required="required"]'))&&t.each(function(){var e=s(this).closest(".gform-settings-input__container");e.hasClass("gform-settings-input__container--invalid")||""===this.value.trim()&&(e.addClass("gform-settings-input__container--invalid"),e.append('<div class="gform-settings-validation__error" id="error-'+this.id+'">'+gforms_google_analytics_feed_strings.required+"</div>"),this.setAttribute("aria-describedby","error-"+this.id))}),s("#TB_ajaxContent").animate({scrollTop:0},300,function(){t&&t.get(0).focus()})}s("#goal_select").on("change",i),s("#select_goal_popup").on("click",function(e){e.preventDefault(),tb_show(gforms_google_analytics_feed_strings.goalcreation,"#TB_inline?inlineId=thickbox_goal_select")}),s("#set_values_popup").on("click",function(e){e.preventDefault(),tb_show(gforms_google_analytics_feed_strings.goalcreation,"#TB_inline?inlineId=thickbox_set_values"),s("#ga_event_goal_id, #ga_event_goal_thickbox, #ga_event_action_thickbox, #ga_event_label_thickbox, #ga_event_value_thickbox, #ga_event_category_thickbox").removeAttr("disabled"),s("#goal_labels, #cancel_goal").show()}),s("#use_goal").on("click",function(e){e.preventDefault();var e=s("#goal_select option:selected"),a=(s("#select_goal_popup").html(gforms_google_analytics_feed_strings.edit),s("#selected_goal").html(e.html()),e.attr("data-category")),t=e.attr("data-action"),o=s.trim(e.attr("data-label")),_=e.attr("data-goal-id"),l="form"===n?"pagination_":"";s("#"+l+"gaeventgoal").prop("value",e.html()),s("#"+l+"gaeventcategory").prop("value",a),s("#"+l+"gaeventaction").prop("value",t),s("#"+l+"gaeventlabel").prop("value",o),s("#"+l+"gaeventgoalid").prop("value",_),s("#gform_setting_feed_event_category p").html(a),s("#gform_setting_feed_event_action p").html(t),s("#gform_setting_feed_event_label p").html(o),s("#gform_setting_feed_event_category, #gform_setting_feed_event_action, #gform_setting_feed_event_label").show(),self.parent.tb_remove()}),s(".goal-creation").on("click","button",function(e){e.preventDefault(),l()}),s("#edit_goal").on("click",function(e){e.preventDefault(),s("#use_goal, #edit_goal, #goal_select, #goal_select_edit, .gforms_goal_create_heading").hide(),s("#ga_event_category_thickbox, #ga_event_action_thickbox, #ga_event_label_thickbox, #ga_event_goal_thickbox").removeAttr("disabled"),s("#goal_labels, .gforms_goal_edit_heading, #update_goal, #cancel_goal").show(),s("#ga_event_goal_thickbox").focus()}),s("#cancel_goal").on("click",function(e){e.preventDefault(),s("#use_goal, #edit_goal, #goal_select, #goal_select_edit").show(),s("#goal_labels, #update_goal, #cancel_goal, #create_goal").hide(),s("#ga_event_category_thickbox, #ga_event_action_thickbox, #ga_event_label_thickbox, #ga_event_goal_thickbox").prop("disabled","disabled")}),s("#close_manual_config").on("click",function(e){e.preventDefault(),self.parent.tb_remove()}),s("#update_goal").on("click",function(e){e.preventDefault();var t=s(this),e=(s("#cancel_goal").hide(),s("#update_goal").prop("disabled","disabled").prop("value",gforms_google_analytics_feed_strings.saving),s.trim(s("#ga_event_goal_thickbox").val())),a=s.trim(s("#ga_event_category_thickbox").val()),o=s.trim(s("#ga_event_action_thickbox").val()),_=s.trim(s("#ga_event_label_thickbox").val()),l=s.trim(s("#gaeventgoalid_thickbox").val()),g=s("#create_ga_goal").val();s.post(ajaxurl,{action:"update_analytics_goal",nonce:g,eventcategory:a,eventaction:o,eventlabel:_,goal:e,goalId:l},function(e){var a;!0===e.success?(r(),s("#selected_goal").html(e.data.goal_name),s("#"+(a="form"===n?"pagination_":"")+"gaeventgoal").prop("value",e.data.goal_name),s("#"+a+"gaeventcategory").prop("value",e.data.event_category),s("#"+a+"gaeventaction").prop("value",e.data.event_action),s("#"+a+"gaeventlabel").prop("value",e.data.event_label),s("#gform_setting_feed_event_category p").html(e.data.event_category),s("#gform_setting_feed_event_action p").html(e.data.event_action),s("#gform_setting_feed_event_label p").html(e.data.event_label),s("#select_goal_popup").html(gforms_google_analytics_feed_strings[a+"edit"]),t.val(gforms_google_analytics_feed_strings[a+"savinganduse"]).removeAttr("disabled"),s("#goal_select option").each(function(){s(this).attr("data-goal-id")==e.data.goal_id&&(s(this).html(e.data.goal_name),s(this).attr("data-action",e.data.event_action),s(this).attr("data-label",e.data.event_label),s(this).attr("data-category",e.data.event_category),s(this).attr("selected","selected"))}),s("#use_goal, #edit_goal, #goal_select, #goal_select_edit").show(),s("#goal_labels, #update_goal, #cancel_goal").hide(),s("#ga_event_category_thickbox, #ga_event_action_thickbox, #ga_event_label_thickbox, #ga_event_goal_thickbox").prop("disabled","disabled")):(c(e),t.val(gforms_google_analytics_feed_strings.pagination_savegoal).removeAttr("disabled"))},"json")}),s("#create_goal").on("click",function(e){e.preventDefault();var t=s(this),o=(t.val(gforms_google_analytics_feed_strings.creating).attr("disabled","disabled"),s.trim(s("#ga_event_goal_thickbox").val())),_=s.trim(s("#ga_event_category_thickbox").val()),l=s.trim(s("#ga_event_action_thickbox").val()),g=s.trim(s("#ga_event_label_thickbox").val()),e=s("#create_ga_goal").val();s.post(ajaxurl,{action:"create_analytics_goal",nonce:e,eventcategory:_,eventaction:l,eventlabel:g,goal:o},function(e){var a;!0===e.success?(r(),s("#"+(a="form"===n?"pagination_":"")+"gaeventgoalid").prop("value",e.data.goal_id),s("#"+a+"gaeventgoal").prop("value",o),s("#"+a+"gaeventcategory").prop("value",_),s("#"+a+"gaeventaction").prop("value",l),s("#"+a+"gaeventlabel").prop("value",g),s("#gform_setting_feed_event_category p").html(_),s("#gform_setting_feed_event_action p").html(l),s("#gform_setting_feed_event_label p").html(g),s("#ga_goals").append(e.data.option),i(),s("#select_goal_popup").html(gforms_google_analytics_feed_strings.edit),s("#selected_goal").html(o),s("#cancel_goal").hide(),t.val(gforms_google_analytics_feed_strings.goalcreated).fadeOut("slow",function(){t.val(gforms_google_analytics_feed_strings.creategoal).removeAttr("disabled")})):(c(e),t.val(gforms_google_analytics_feed_strings.pagination_creategoal).removeAttr("disabled"))},"json")}),s("#set_event_values").on("click",function(e){e.preventDefault();s(this);var e=s.trim(s("#ga_event_goal_thickbox").val()),a=s.trim(s("#ga_event_category_thickbox").val()),t=s.trim(s("#ga_event_action_thickbox").val()),o=s.trim(s("#ga_event_label_thickbox").val()),_=(s("#create_ga_goal").val(),"form"===n?"pagination_":"");s("#"+_+"gaeventgoalid").prop("value",null),s("#"+_+"gaeventgoal").prop("value",e),s("#"+_+"gaeventcategory").prop("value",a),s("#"+_+"gaeventaction").prop("value",t),s("#"+_+"gaeventlabel").prop("value",o),s("#selected_goal").html(e),s("#gform_setting_feed_event_category p").html(a),s("#gform_setting_feed_event_action p").html(t),s("#gform_setting_feed_event_label p").html(o),s("#gform_setting_feed_event_category, #gform_setting_feed_event_action, #gform_setting_feed_event_label").show(),self.parent.tb_remove()}),i()})}((window.GF_Google_Analytics_Feed=window.GF_Google_Analytics_Feed||{},jQuery));