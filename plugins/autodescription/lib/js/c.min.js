'use strict';window.tsfC=function(){const a="undefined"!=typeof tsfCL10n&&tsfCL10n;let b=+(a.counterType||0);const c=()=>b,d={0:"tsf-counter-zero",1:"tsf-counter-one",2:"tsf-counter-two",3:"tsf-counter-three"},e=c=>{let e=c.e,f=tsf.decodeEntities(c.text),g=a.guidelines[c.field][c.type].chars,h=tsf.getStringLength(f),i="",j="",k={bad:"tsf-count-bad",okay:"tsf-count-okay",good:"tsf-count-good",unknown:"tsf-count-unknown"};switch(h?h<g.lower?(i=k.bad,j=a.i18n.guidelines.short.farTooShort):h<g.goodLower?(i=k.okay,j=a.i18n.guidelines.short.tooShort):h>g.upper?(i=k.bad,j=a.i18n.guidelines.short.farTooLong):h>g.goodUpper?(i=k.okay,j=a.i18n.guidelines.short.tooLong):(i=k.good,j=a.i18n.guidelines.short.good):(i=k.unknown,j=a.i18n.guidelines.short.empty),b){case 3:j=`${h} &ndash; ${j}`;break;case 2:break;case 1:default:j=h;}for(let a in e.innerHTML=j,k)e.classList.remove(k[a]);for(let a in d)e.classList.remove(d[a]);e.classList.add(i),e.classList.add(d[b])},f=()=>{window.dispatchEvent(new CustomEvent("tsf-counter-updated"))},g=a=>{a&&++b,3<b&&(b=0),f()},h=()=>{g(!0);let a=".tsf-counter-wrap .tsf-ajax",c=0;tsf.resetAjaxLoader(a),tsf.setAjaxLoader(a),wp.ajax.post("tsf_update_counter",{nonce:tsf.l10n.nonces.edit_posts,val:b}).done(b=>{switch(b=tsf.convertJSONResponse(b),"success"===b.type&&(c=1),c){case 0:tsf.unsetAjaxLoader(a,!1);break;case 1:tsf.unsetAjaxLoader(a,!0);break;default:tsf.resetAjaxLoader(a);}}).fail(()=>{tsf.unsetAjaxLoader(a,!1)})},i=()=>document.querySelectorAll(".tsf-counter").forEach(a=>a.addEventListener("click",h)),j=()=>{i()};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",j)}},{updatePixelCounter:b=>{let c=b.e,d=tsf.decodeEntities(b.text),e=a.guidelines[b.field][b.type].pixels,f=c.parentElement;if(!f)return;let g=f.querySelector(".tsf-pixel-counter-bar"),h=f.querySelector(".tsf-pixel-counter-shadow");if(!g||!h)return;h.innerHTML=tsf.escapeString(d);let i=h.offsetWidth,j="",k="",l="",m={bad:"tsf-pixel-counter-bad",okay:"tsf-pixel-counter-okay",good:"tsf-pixel-counter-good",unknown:"tsf-pixel-counter-unknown"};k=100*(i/e.goodUpper)+"%",i?i<e.lower?(j=m.bad,l=a.i18n.guidelines.long.farTooShort):i<e.goodLower?(j=m.okay,l=a.i18n.guidelines.long.tooShort):i>e.upper?(k=100*(e.upper/(i+2*(i-e.upper)/3))+"%",j=m.bad,l=a.i18n.guidelines.long.farTooLong):i>e.goodUpper?(j=m.okay,l=a.i18n.guidelines.long.tooLong,k="100%"):(j=m.good,l=a.i18n.guidelines.long.good):(j=m.unknown,k="100%",l=a.i18n.guidelines.long.empty);let n,o=g.querySelector(".tsf-pixel-counter-fluid");n=a.i18n.pixelsUsed.replace(/%1\$d/g,i),n=n.replace(/%2\$d/g,e.goodUpper),n+="<br>"+l,g.classList.remove(...Object.values(m)),g.classList.add(j),o.style.width=k,g.dataset.desc=n,g.setAttribute("aria-label",tsf.escapeString(n.replace(/(<([^>]+)?>?)/ig," "))),tsfTT.triggerUpdate(g)},updateCharacterCounter:e,triggerCounterUpdate:f,resetCounterListener:i,getCounterType:c},{counterClasses:d,l10n:a})}(),window.tsfC.load();
